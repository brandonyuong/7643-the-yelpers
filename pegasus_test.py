from transformers import PegasusForConditionalGeneration, PegasusTokenizer
import torch

torch_device = torch.device("cuda" if torch.cuda.is_available() else "cpu")

# src_text = [
#     """ PG&E stated it scheduled the blackouts in response to forecasts for high winds amid dry conditions. The aim is to reduce the risk of wildfires. Nearly 800 thousand customers were scheduled to be affected by the shutoffs which were expected to last through at least midday tomorrow."""
# ]

src_text = [
    """
    A 3D-printed antenna could turn high-frequency 5G signals into a wireless power source, potentially eliminating the need for batteries in low-power IoT devices, according to researchers at Georgia Tech.
The antenna, which the researchers call a mm-wave harvester, is about the size of a playing card and has visible circuitry printed on it. It uses a technology called a Rotman lens as a waveguide to focus multiple beams of millimeter-wave electromagnetic radiation used in 5G into a coherent whole.

The technology was previously best known as a component of phased-array radar systems, allowing it to see targets in multiple directions without physically moving the antenna system. It was invented in the 1960s by US Air Force and MIT researcher Walter Rotman.
“People have attempted to do energy harvesting at high frequencies like 24 or 35GHz before,” said Aline Eid, a senior researcher a Georgia Tech’s ATHENA lab in the School of Electrical and Computer Engineering. The shortcoming of the previous iterations was it only worked if the lens was oriented directly toward the transmitter. That made it difficult to position correctly and ruled out using it if the device it was powering moved around.

It also helps that millimeter-wave 5G signals are much more energy-dense than previous generations of licensed wireless technology, making them more suitable for energy harvesting.

The Georgia Tech team’s design works more like an optical lens with six simultaneous fields of view, thanks to different curvature angles on the beam-port and antenna sides of the device. This allows the system to map multiple 5G signals at the same time, focusing them on the lens and power rectifiers to transformation the gathered signals into usable electrical energy. The result is that the system can generate 21 times as much power as a non-Rotman-based system, while being relatively simple to produce.

Manos Tentzeris, a professor at Georgia Tech’s School of Electrical and Computer Engineering, said that the forthcoming ubiquity of 5G means that the Rotman lens-based technology could wind up powering huge numbers of IoT devices.

“The fact is 5G is going to be everywhere, especially in urban areas,” he said. The antennas could save a lot of money if IoT devices don’t have batteries that die and need to be swapped out. “You can replace millions, or tens of millions, of batteries of wireless sensors, especially for smart-city and smart-agricultural applications.”

The system isn’t without its drawbacks, however. For one thing, it’s still in the experimental stages, with no data available on when it might become available for commercial use. For another, it’s still quite short-ranged--the experiments centered on a harvesting range of less than three meters, with a theoretical maximum of 16.

Nevertheless, the potential applications for the fast-growing world of IoT are hard to overemphasize. Statista predicts that 5.4 billion IoT devices will be in use by 2025 in North America alone, and with further development of the Georgia Tech system’s effective range, many of them could be powered by 5G signals.
    """
]

# src_text = [
#     """ Banh mi was pretty weak.,We had the chicken and BBQ pork banh mi and the laos noodles. All was disappointing in taste and presentation. The sandwiches are better tasting at the Asian Shopping Center.\n\nService was friendly and attentive.,I would love to try the food, however I can\'t get them to answer the phone. Today, their phone was off for two hours, and when they finally answered, I was told they wouldn\'t be delivering. They probably have delicious food, but I can already tell they have terrible customer service. \nSeeing as my entire work experience has centered around customer service, I find it somewhat insulting to have a restaurant rely souly on the quality of their food, and have complete disregard for their customer service.,It pains me to write this article because I love the food cart culture in Austin and the ambition and courage of many of these proprietors...\n\n....there is a big ol\' \'but\' coming here....\n\nI was a big fan of Me So Hungry when it first opened. The place was run well, the food came out fast and tasty (even when busy), and the prices were reasonable...\n\nBUT....\n\nNow I\'m not so much a fan. I swore off Me So Hungry when I waited 45 minutes for a $6 ($6!?) banh mi that fell apart in my lap after the first bite. The look of defeat on my face the moment that BBQ\'d chicken fell in my crotch said it all- "I shall frequent this place no more". Also, let me add that I ordered this banh mi during a quiet time of the day. \n\nI guess they ran out of chicken, but didn\'t tell me that until 30 minutes in.  I was freakin\' hungry too!\n\nOk, so I wouldn\'t be writing this if this wasn\'t becoming repetitious behavior. The situation was the last straw and prior to then I had become increasingly unhappy with the service and the quality of the food. Raising the prices didn\'t help.\n\nI liked you guys. Actually, I looooved you. What the heck happened?,Me So, what happened to you!?\n\nThis place used to be one of my absolute favorites. And lately I have had nothing with bad experiences: over cooked tofu, little to no flavoring, and sometimes complete and total disregard for what I actually order. Unfortunately, it usually happens when I\'m at work and I don\'t have time to go back and wait for another 15 minutes for them to replace it.\n\nMe So, I think we\'re going to have to call this thing off.  It\'s not me, it\'s you.,Way overrated.  Another bahn mi fail for Austin.  The allure of banh mi is good, cheap, quick, and relatively healthy.  None of which Me So Hungry fulfilled.  \n\nA good banh mi is a balancing act of flavors.  Instead I got a banh mi drenched in their "signature" sweet cilantro mayo.  Turned the entire sandwich into a greasy slop where the only thing I could taste is the mayo... gross.  I was only able to stomach half, while throwing the other half away.,Seriously? Went there today because fresh off the truck was closed and I wanted bahn mi. first off, the dude was rude. When I told him to give me noodles with the mildest sauce for my kid, he was dumbfounded. when I came to get my order I noticed the guy rolling up my roll with his bare hands had the most disgustingly dirty fingernails. I watch people make me sandwiches with bare hands all the time, but this was serious dirt yall. Then we started eating. First of all the sandwich was drenched in creamy weirdness and I was not a fan of that. Second, the tofu...it was like nothing I have ever seen. Tough unrecognizable triangles. third, the noodles and rolls were full of all kinds of weird shit. My daughter wouldn\'t eat her noodles so I tried. I kept finding like wilted brown lettuce and random pieces of vegetables. I made it through the rolls but I chunked everything else. I never waste food but this place was two thumbs down. Maybe I caught them on an off day but I won\'t be going back. Sorry :(,Yuck. The person working the food truck shouldn\'t be DRUNK when he handles other people\'s food. Too bad we didn\'t realize it until he had already charged the card. He actually went to use the outhouse in the middle of making our food. We decided not to eat it. What a waste. This is such a shame because apparently this place gets great reviews and I was looking forward to trying it.,I ended up here again on accident as my friends wanted to try out some of the East Side King\'s trailers and couldn\'t get in due to one of our party being under 21 and The Grackle being closed. I had tried the banh mi before and wanted to try their noodles this time around.\n\nI got a large red curry noodles with bbq pork and between my friends (who also ordered noodles) and me we basically tried out all three sauces. First of all, for $8.50 the portion size of the large was gigantic. About 3x the amount you\'d get for a small ($6). However, this size may work against them. The bbq pork was sparsely sprinkled over the gigantic container of noodles and both the flavor and the pork itself was lost. The dish was a bit too sweet for me. The cilantro did come through and there was plenty of spice, but because the overpowering sweetness of the dish I was basically done in a couple bites. Furthermore, the dish was very watery, and didn\'t have a lot of texture. My friends basically reflected similar discontent for all three sauces they offered.\n\nI am still a fan of the banh mi here, but, at least for me, the noodles are something to stay away from here.,Me So Hungry earns 1 star because the owner\'s boyfriend was super friendly to us. Otherwise, please resist your temptation for late night chinese food from the side of the road. As enticing as the woman on the side of the truck is, keep driving. My friend and I tried the Pad Thai. There was nothing Thai about this. I have no idea what was on the noodles but the flavor was no where close to what Pad Thai is supposed to taste like. Thank god we grabbed some sweet and sour sauce to make it edible. To top it off, the noodles stuck together in one huge clump and was unbearable to try to eat. I should have gone with my instinct and ordered a Wok-It-Out bowl but their sauce options turned me off. Naughty-n-Nice Spice? What in the world is that??,Me so disappoint.\n\ngrowing up eating from places like thiem hung and les givral\'s in houston (real vietnamese sandwich shops), i know a good vietnamese sammich when i see one. \n\ni remember driving up to this place at 2:30am (closing time at 3am) and the lady saying \'we are closed. me so sorry\'. eh, cool, i\'ll try again next time.\n\nso fast forward to next time. \n\n$5 for a sandwich. It better be a damn good sandwich. \n\nnothing about this sandwich was right.\nsriracha on a banh mi??\n\'mexican style\' french bread?\nwhat is that white sauce they slop all over it?\nwhat is with this meat? its all wrong wrong wrong. \n\nthe sandwich looked like a drunken messy torta, and i didnt even pick it up yet. it was a soggy mess.\n\ni guess if you throw cilantro, meat and sriracha together, label it \'asian\', upcharge 150%, and sell it out of a trailer at 2am on the east side, it\'s an automatic \'to die for\'.,I am convinced people rating this trailer above three stars have never actually been to any of the better places in the city. This hands down the worst vietnamese food I have ever had. The Banh Mi is a total joke. The Pad Laos noodles were a complete glue blob and the tofu was shoe leather.  I guess the pork was okay, but that was about the only acceptable thing. \n\nOur spring rolls were already tearing apart when we got them and were bursting with flavorless noodles.  The "peanut sauce" was essentially peanut butter. It was so thick I couldn\'t even dip my spring roll in it. \n\nI never saw the owner, so perhaps it was her night off? \nI think this place suffers from "YTS" or "Yelp Trailer Syndrome". The notable symptom of this condition being  the need to way way way overrate anything that comes out of trailer.,I came here, hoping for some good Asian or Asian fusion food, since it has good reviews. I\'m Asian, grew up in Southeast Asia, permanently living in California, temporarily in New Mexico. There\'s no good Asian food in the boonie town I live in NM so I wanted some Asian food. I must say, my boyfriend and I were disappointed.\n\nI order Pad Thai and spring rolls. Not that good. I think maybe it\'s mostly white people who gave the reviews. Try East Side King instead. It\'s not exactly Asian (but by an Asian American chef), but it\'s way way way better.,I have just returned from Disappointmentville, and I am not pleased. \n\nMy friend once gave me a bite of her Banh Mi sandwich from the west sixth incarnation of this trailer and I have been wanting to get one of my own over since. I spotted its twin while cruising up east sixth with my friends last night and we agreed to come the next day for dinner. \n\nFirst off, the service. I mean, maybe it was a Sunday night so this place didn\'t have it\'s A-Team out, but this guy seriously could not have been more unenthusiastic. I generally try to ask cooks or severs their opinions on food, but when I asked if the pork or chicken was better, he curtly responded with, "I\'m a vegetarian," which was followed by a holier than thou stare that would have resulted in my stalking off had my friends not already ordered. I have no problems with vegetarians. My boyfriend is a vegetarian. I enjoy vegetarian food, but I do not need the \'tude, especially from someone I am about to hand my money to. \n\nWe wait and I am handed my sandwich, of which I take a bite and am given a mouthful of only bread. I bite again: mostly bread and some mayo. Next bite: more bread, and some carrots. At this point I set the sandwich down and opened it up, wondering if in some sort of protest I had been given a meatless sandwich. After pushing away sauce and limp vegetables, I found three small pieces of pork. Mind you, I had been at Korea House for lunch, so maybe I was a little biased, but this pretty low quality meat (what little of it there was). It was unpleasantly chewy. I didn\'t enjoy the sauce or the vegetables much either, and couldn\'t believe that a food trailer had just charged me six bucks for this. I hardly ate any of it.\n\nMy entire table was under whelmed. My friend got a dish with tofu and said it tasted alright, but she could get something twice as good for half the price elsewhere. Unfortunately, unbeknownst to me, most food stands in that area are closed on Sunday nights, so I left with a grumbling stomach and a grumbling me. Grrrr.,Me so bummed. Me left so hungry.\n\nI used to really love this place when they first opened a few years back. I drank more then, so maybe I was just under the influence. I was particularly into the lemongrass tofu banh mi and some kind of spicier noodles with tofu.\n\nRecently, Me So Hungry has been less exciting and satisfying. About a month ago, I stopped off on my way home from barhopping around midnight, and attempted to get a banh mi, but I was ignored by the employee in the trailer for 5 minutes, so I went home and made a snack in my own kitchen. This past weekend, I visited cheer up\'s with a friend and opted for some noodles (pad laos, perhaps? the spicy ones). There was still a bit of a wait until I was acknowledged and my order was taken - forgivable, since they only had one employee in there - but dude! My noodles! \n\nHot noodles, served in a plastic container that was definitely NOT microwavable and I assume was not BPA free. I can feel the tumor growing right now. But me was so hungry, so I can power through that, right? Right? Ugh, fraid not. Me so confused - why are the noodles super sweet and super spicy and simultaneously super bland? I was really in the mood for salt. But salty was distinctively missing from my dish. Me so sad. After several bites, I gave up. Even my dog was uninterested in my noodles.,Maybe I\'m being unfair. I\'ve only tried the pork bahn mi, but I\'ve tried it three times and each time it\'s been worse than before.\n\nThe most recent incarnation of a sandwich I\'ve had in many forms disappoints on a whole new level of let-down. The bracingly crisp exterior of the usual french bread has been replaced by a slightly smaller and much softer bolillo (the kind that typically makes my favorite torta a more yielding treat). This would be forgivable, had the filling not consisted of a rubbery cutlet with zero flavor, braced against a giant mass of bland vegetable, all swamped with mayonnaise that bore only the slightest whisper of Sriracha. I had been asked if I wanted my sandwich spicy, and responded with a very emphatic "VERY."\n\nI don\'t want to get into the to more unpleasant ways I felt about the experience. I spent the rest of the night eating anything I could find, just trying to forget about it.\n\nAlso, what the HELL with that name?,2 stars for decent ingredients on the banh mi, but everything else was barely even average in my opinion.  the spring roll and the pad thai or whatever are not worth the time/money at all.  really i had to give this 1 star though to even out all the ridiculous 5 stars this place is getting cause if you look closely at the reviews it\'s mostly just people eating the banh mi and i do hope most of you were drunk or desperately hungry to rationalize giving this place a perfect score.,I used to love this place.\nThen it changed for the worse. The meat still tastes the same but the bread they use is wayyyyyy too dense. Then I think they got incorporated into Cheer Up Charlies so that (last Saturday night, at least) you have to go through Cheer Up Charlies to get to Me So Hungry. That means you have to be 21 to eat here O.O\nFortunately, I\'m 21... But it would be annoying for me to have to go through Cheer Up Charlies first. I wouldn\'t mind if they changed their bread though! \n\nInstead, I found CoolHaus (which was AWESOME) on the other side of the yard.\nNot fenced in. But that\'s another review. \n\nPLEASE PLEASE CHANGE YOUR BREAD ME SO HUNGRY!,The guy basically told me to go to wendy\'s cause he only had two other orders the night. The food is great; the service is definitely iffy. I live close by and love this place, but all depends on who is working the trailer.,Me so disappointed - I opened my Bánh mì to take a pic and immediately started thinking about those old Wendy\'s commercials, as in "Where\'s the Mì?" When you leave some place thinking you have to make excuses for them, like "Maybe they were having a bad day," or "Maybe they\'re saving their good stuff for the nighttime bar crowd," then it\'s probably not a good sign. \n\nMaybe my expectations were just too high: People I admire rave about this iconic trailer, and I was truly expecting to be blown away. It didn\'t happen. For $6, I felt like I was eating an interesting bread sandwich. And when I bit into some jalapeno during my last two bites, it tasted like an interesting tangy bread sandwich. Maybe the first six bites were too subtle for my palate. \n\nI didn\'t mind the wilted leaves of whatever it was in my $4 worth of lemongrass tofu rolls, what I minded was wondering what and where the lemongrass tofu was - was it that one brown cubed thing I found at the end of a roll? You\'re kidding me. Props for the spring rolls being made on order, but unprops for them being tasteless as well. The peanut dipping sauce was a big help, but it so thick it was like peanut butter taken straight from a refrigerator. I offered my other spring roll to a fellow Asian in our party, she looked at briefly and then politely declined. I wound up tossing it. That\'s the way the spring roll bounces. \n\nMaybe I should have gone for their signature stir-fried noodle bowl, but that just didn\'t appeal to me at 98-degrees in the shade. On a positive note, I could make a case if Me So Hungry was the only place in town you were ever considering having a Bánh mì at, then go for it, it won\'t be bad at all. But Austin has so many interesting choices now, that you should probably give some serious thought to your other options, like Me Go Somewhere Else.,If there were a way to give this Christina Alfonso and her "team" zero stars, I would absolutely do it.  Reviews on here are mostly with regards to the Me So Hungry food truck, but since shutting down the food truck Me So Hungry continues to operate a catering and event coordination business.\n\nThe sell: Christina formerly operated a pretty successful food truck in ATX.  She has been catering through the truck for years, and now even with the truck shut down has contacts with "chefs" that she works through to continue her catering business.  She additionally sells are wares as an event coordinator.  You get a $150 break on coordination services if you also use her for catering.\n\nThe start: Christina is very sweet and charismatic over email and by phone. We have an initial meeting at our reception location 7 months before the wedding.  She is late, but we love her laid back vibe and ideas.  I ask for the coordination contract.  Over a month later I finally receive the contract, though I ask many times for it.  I return the signed contract and a check for the deposit and do not hear one WORD from her from November 2013 to Feb 2014.  I emailed, called, texted...you name it. 3 months later she responds with 20 page emails, which in the end, answer none of my fears/questions.\n\nNOTE: My instinct at this point was to FIRE her and just lose out on the money.  But we were on a tight budget, and she really does seem so friendly. This method of disappearing, not communicating and then profusely apologizing without ever making anything better, was her mode of operations up until the day she ruined our wedding reception.\n\nThe short list of grievances: \n* Christina was late for every.single. appointment we ever had beginning in October 2013 all the way through our wedding day in May 2014.  \n* Left the wedding rehearsal when she was supposed to have set out tables, and then the day of the wedding, left her "assistant" day of coordinator alone to do all set-up by herself. The end result was, set-up was not complete when guests arrived.\n* The experience bar-tender I paid for was under the age of 18 (so not able to legally serve alcohol). Additionally this person had no clue how to open a bottle of wine and my bridal party ended up doing drink service for cocktail hour.  \n* The "assistant" coordinator was not able to do the set-up planned and 90% of the visual items planned for the wedding never happened.  \n* We paid for cake service, no cake cutting utensils were brought and again my bridal party cut the cake.  The even coordinator was so far underwater trying to keep the event on schedule and busting tables that she couldn\'t even help with cake service...Which brings me to my next point:\n* The catering staff did NO clean up during the reception, meaning all 24 tables were covered in dirty plates and glasses.  \n* The groom and I never one had a bite of hot food.  Everything on the line was cold although our entire food set-up had been done such that Christina had TWO full kitchens to cook in (on-site) and a set-up of many deep fryers so that all food would be hot and fresh.  Not one thing that day was served to me hot. \n* Over 30% of the menu we ordered was never served.  I\'m not sure it matters as it would have been cold anyhow, but the vegetarian options we ordered including mac and cheese balls and grilled cheese (for vegetarians and children in attendance) were never served.\n* Christina left before food service, I never saw her on my wedding day.  When I started asking serious questions about why everything was a mess, where the food was, why no one was busting tables, etc. Christina\'s event "staff" disclosed that she was actually at another wedding.\n* The Assistant coordinator, her own staff and myself have ALL been trying to reach Christina since this day. She has yet to return a single phone call or email about the absolutely AWFUL service and experience we had.  She deleted me from facebook that night and took down her Me So Hungry facebook page and website that night.\n\nThere are many WONDERFUL vendors in Austin who would have the opportunity to have your business.  Our day of coordinator was a God send...she is the only reason we were even to pull things together enough to have a reception.  Also, the woman that did our cake: AMAZING!  You can find prices as good as Christina\'s if you look (try Verde\'s).  Do not waste your time on her. She does not deserve your trust or business and will leave you nothing but disappointed.,This place has declined before my eyes.  The sandwiches just aren\'t very good anymore, and they\'re smaller and more expensive.  I\'ve given the place about 5 more tries before declaring this, and I\'m sad to report that they have reconfirmed my suspicions each time.\n\nI will go to Lulu B\'s for my banh mi needs from now on.,When I ask for no mayo then I expect no mayo.  I hated having to give my bahn mi away bc it had mayo on it.  What a way to start your day.  And with only two people in the truck either somebody wrote it wrong, somebody read it wrong or this is a business that just isn\'t concerned about repeat customers.  And for $6...I can go to Chinatown and get a bahn mi for less than $3 and guess what...their English isn\'t as good but they understand "no may"...imagine that.  So even though I didn\'t get to taste my sandwich...based on the service I won\'t be back,The food has always been fairly tasty almost every time I\'ve tried it, but it\'s officially a permanent pass for me after my last two experiences. The first involved a long 40 minute wait in the cold with no advance warning that it would take so long to complete my order. Last Thursday\'s experience, however, was much worse.\n\nI\'m talking entirely about a service issue... Some guy working the trailer who seems to be way too busy being awesome than to pay attention to a customer who\'s sober, not dressed ridiculously, and just wants to pay for some food, take it home, and have a late dinner. I\'ve dealt with this attitude before at Me So Hungry and tried to overlook it. This most recent round has made me swear off for good. \n\nLet\'s see... \n\nCan\'t manage to say anything to me and just stare back at me when I walk up and say, "Hi. How are you?". \n\nSinging the music you\'re listening to loudly and dancing around while I\'m ordering, not acknowledging that you\'ve even heard what I want.\n\nYelling at me 5 minutes after I\'ve placed my order that you\'ve given me too much change and I need to give you some money back.\n\nSeeming to not know that I\'m the person who just ordered a bahn mi and noodle bowl from you, even though it happened fifteen minutes ago, I\'ve been standing by the not-crowded trailer the entire time since, and only one other customer has ordered after me. \n\n Saying nothing in the way of thank you... or even you\'re welcome after I\'ve said thank you upon receiving my food. \n\nYeah, I\'m done with this place. Try hiring some employees that represent your business well... And if you\'re cool with people working for you who are rude and not paying attention to the work they\'re doing, then I don\'t really need to spend my money at your food trailer. There are plenty of other good options.,It was like 1AM, there was a cover at Shangri\'la and I\'m way too cool to pay a cover. Cheer up Charlies being a short hike away sounded like a good deal. We got to the bar settled down and suddenly I have the munchies. Hello MeSoHungry.... \n\nSpring rolls where just about all they actually had because it was so late and they were closing soon. What I got was more like a spring roll burrito . I appreciate the extra portions and all but it was hard to eat and over stuffed over sized spring roll.  I needed about 10 times as much peanut sauce to make it work. \n\nI had an assortment of the spring rolls and the smaller ones where ok but nothing hit me in taste buds here and made me say way. I\'d like to try the bahn mi at some point . Maybe it will motivate me to give them and extra star or two. For now I\'m gonna say they are pretty lack luster. The name is cool. The truck is cool. The food was meh"""
# ]

model_name = 'google/pegasus-xsum'
device = 'cuda' if torch.cuda.is_available() else 'cpu'
tokenizer = PegasusTokenizer.from_pretrained(model_name)
model = PegasusForConditionalGeneration.from_pretrained(model_name).to(device)
batch = tokenizer(src_text, truncation=True, padding='longest', return_tensors="pt").to(torch_device)
translated = model.generate(**batch)
tgt_text = tokenizer.batch_decode(translated, skip_special_tokens=True)
# assert tgt_text[0] == "California's largest electricity provider has turned off power to hundreds of thousands of customers."
print(tgt_text[0])
